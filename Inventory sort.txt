#!/usr/bin/env python3"""Inventory Categorization Script================================Automatically categorizes inventory items into storage locations and excludesitems that should never be counted (fresh produce, dry seasonings, fresh bread).Usage:    python categorize_inventory.py input_file.xlsx output_file.xlsxRequirements:    pip install pandas openpyxl"""import sysimport pandas as pdfrom pathlib import Pathdef categorize_item(item_desc, brand='', pack_type=''):    """    Categorize an inventory item based on its description.        Returns one of:        - 'Freezer'        - 'Walk In Cooler'        - 'Beverage Room'        - 'Dry Storage Food'        - 'Dry Storage Supplies'        - 'Chemical Locker'        - 'NEVER INVENTORY' (for fresh produce, dry seasonings, fresh bread)        - 'UNASSIGNED' (needs manual review)    """    item_upper = str(item_desc).upper()        # ========================================================================    # NEVER INVENTORY - Fresh produce, dry seasonings, fresh bread    # ========================================================================    never_inventory_keywords = [        # Fresh produce only (not prepared/processed)        'LETTUCE', 'TOMATO BULK', 'TOMATO GRAPE FRSH', 'TOMATO SLI FRSH',        'CUCUMBER FRESH', 'CUCUMBER ENGLISH',         'SPINACH BABY FRSH', 'SPINACH CLIPPED FRESH',        'MUSHROOM SLCD FRESH', 'CABBAGE DICED',        'GRAPE RED SDLS FRESH', 'STRAWBERRY WHL IQF',                # Dry seasonings (not sauces or prepared items)        'SEASONING CAJUN', 'SEASONING CARIBBEAN', 'SEASONING CHICKEN MONTREAL',        'SEASONING RUB OLD BAY', 'SEASONING STEAK MONTREAL', 'SEASONING TACO',        'SPICE GARLIC PWDR', 'SPICE PEPPER BLK TABLE',                # Fresh bread from Rockland        'TOAST FRENCH STICK', 'DANISH ASST IW', 'BREAD FRESH'    ]        for keyword in never_inventory_keywords:        if keyword in item_upper:            return 'NEVER INVENTORY'        # ========================================================================    # FREEZER - Frozen items, appetizers, frozen entrees    # ========================================================================    freezer_keywords = [        'FROZ', 'FROZEN', 'APTZR', 'PIEROG', 'PIZZA',        'FRY', 'FRIES', 'TATER TOT', 'HASH BRN',        'BEAN GREEN WHL', 'BEAN LIMA', 'BROCCOLI FLORET', 'CORN WHL KERNEL',        'PEA & CARROT', 'VEGETABLE BLEND', 'VEGETABLE MIX',        'CRAB CAKE', 'WING', 'NUGGET', 'TENDER', 'POPCORN',        'ENTREE', 'MEATLOAF', 'SALISBURY', 'MACARONI & CHEESE',        'FRENCH STICK HT&SRV', 'STEAK PHILLY'    ]        # Special case: potato items with FRY/HASH/TATER go to freezer    if 'POTATO' in item_upper and any(kw in item_upper for kw in ['FRY', 'HASH', 'TATER']):        return 'Freezer'        for keyword in freezer_keywords:        if keyword in item_upper:            return 'Freezer'        # ========================================================================    # WALK-IN COOLER - Dairy, meat, eggs, prepared produce, juice    # ========================================================================    cooler_keywords = [        # Dairy        'MILK', 'CHEESE', 'BUTTER', 'CREAM', 'YOGURT', 'SOUR',                # Eggs        'EGG',                # Meat/Protein        'CHICKEN', 'BEEF', 'PORK', 'TURKEY', 'BACON', 'HAM', 'SAUSAGE',         'FRANK', 'MEATBALL', 'SCRAPPLE',                # Deli/Prepared        'DELI', 'CRAB IMIT', 'TOPPING WHPD', 'RAVIOLI', 'PASTA SHELL STFD',                # Refrigerated sauces/condiments        'JUICE', 'SALSA', 'HUMMUS', 'CREAMER', 'GRAVY', 'SAUCE CHEESE',                # Prepared produce (DO count these)        'ONION RING', 'ONION SLICED', 'ONION DICED', 'ONION YELLOW DICED',        'PEPPER ROASTED', 'PEPPER GREEN DICED'    ]        for keyword in cooler_keywords:        if keyword in item_upper:            return 'Walk In Cooler'        # ========================================================================    # BEVERAGE ROOM - Drinks, coffee, tea    # ========================================================================    beverage_keywords = [        'DRINK ENERGY', 'COFFEE GRND', 'TEA HOT', 'WATER SPRING'    ]        for keyword in beverage_keywords:        if keyword in item_upper:            return 'Beverage Room'        # ========================================================================    # DRY STORAGE - FOOD    # ========================================================================    dry_food_keywords = [        # Oils & cooking basics        'OIL', 'SHORTENING', 'PAN COATING', 'EXTRACT',                # Pasta & grains        'PASTA', 'RICE', 'CEREAL', 'GRANOLA', 'OATMEAL',                # Canned goods        'BEAN REFRIED', 'CHILI', 'TUNA', 'SOUP',                # Snacks        'CHIP', 'CRACKER', 'COOKIE', 'DOUGH COOKIE',                # Condiments & sauces        'SAUCE', 'KETCHUP', 'MUSTARD', 'MAYO', 'DRESSING',        'PUDDING', 'JELLY', 'JAM', 'SYRUP',                # Other dry goods        'CROUTON', 'SAUERKRAUT', 'CRANBERRY DRIED', 'CRAISINS',                # Potatoes (non-frozen)        'POTATO WHL', 'POTATO SWEET', 'POTATO YUKON', 'POTATO AU GRATIN',         'POTATO CKD', 'POTATO CHIP NAT'    ]        for keyword in dry_food_keywords:        if keyword in item_upper:            return 'Dry Storage Food'        # ========================================================================    # DRY STORAGE - SUPPLIES    # ========================================================================    supply_keywords = [        'GLOVE', 'NAPKIN', 'TOWEL', 'FILM', 'FOIL', 'WRAP',        'BAG', 'CONTAINER', 'CUP', 'LID', 'PLATE', 'BOWL', 'TRAY',        'FORK', 'KNIFE', 'SPOON', 'LINER', 'TISSUE'    ]        for keyword in supply_keywords:        if keyword in item_upper:            return 'Dry Storage Supplies'        # ========================================================================    # CHEMICAL LOCKER    # ========================================================================    chemical_keywords = [        'CLEAN', 'SANITIZ', 'DETERGENT', 'SOAP', 'DEGREASER', 'DESCALER'    ]        for keyword in chemical_keywords:        if keyword in item_upper:            return 'Chemical Locker'        # If we get here, item needs manual categorization    return 'UNASSIGNED'def process_inventory(input_file, output_file=None):    """    Process an inventory template file and categorize all items.        Args:        input_file: Path to input Excel file        output_file: Path to output Excel file (optional, defaults to input_categorized.xlsx)        Returns:        DataFrame with categorized items    """    print(f" Reading: {input_file}")        # Load the Excel file    df = pd.read_excel(input_file)        print(f"   Found {len(df)} items")    print()        # Apply categorization    print(" Categorizing items...")    df['Location'] = df.apply(        lambda row: categorize_item(            row['Item Description'],            row.get('Brand', ''),            row.get('Pack Type', '')        ),        axis=1    )        # Sort by Location, then Item Description    df_sorted = df.sort_values(['Location', 'Item Description'])        # Generate summary    print()    print("=" * 70)    print("CATEGORIZATION RESULTS:")    print("=" * 70)        location_counts = df_sorted['Location'].value_counts()        # Items to count    inventory_items = df_sorted[df_sorted['Location'] != 'NEVER INVENTORY']    never_inv = df_sorted[df_sorted['Location'] == 'NEVER INVENTORY']    unassigned = df_sorted[df_sorted['Location'] == 'UNASSIGNED']        print()    print("Items TO COUNT:")    for location in ['Freezer', 'Walk In Cooler', 'Beverage Room',                      'Dry Storage Food', 'Dry Storage Supplies', 'Chemical Locker']:        if location in location_counts:            count = location_counts[location]            print(f"  {location:.<30} {count:>3} items")        print()    print(f"Items NEVER COUNT:............... {len(never_inv):>3} items")        if len(unassigned) > 0:        print(f"Items UNASSIGNED (manual review):  {len(unassigned):>3} items")        print()    print(f"TOTAL ITEMS:..................... {len(df_sorted):>3}")    print(f"CATEGORIZATION ACCURACY:......... {((len(df_sorted) - len(unassigned)) / len(df_sorted) * 100):.1f}%")    print()        # Show never inventory items    if len(never_inv) > 0:        print("=" * 70)        print("NEVER INVENTORY ITEMS:")        print("=" * 70)        for idx, row in never_inv.iterrows():            print(f"  - {row['Item Description']}")        print()        # Show unassigned items    if len(unassigned) > 0:        print("=" * 70)        print("  UNASSIGNED ITEMS (need manual review):")        print("=" * 70)        for idx, row in unassigned.iterrows():            print(f"  - {row['Item Description']}")        print()        # Save output file    if output_file is None:        input_path = Path(input_file)        output_file = input_path.parent / f"{input_path.stem}_categorized{input_path.suffix}"        df_sorted.to_excel(output_file, index=False)    print(f" Saved: {output_file}")    print()        return df_sorteddef main():    """Main entry point for the script."""    print()    print("=" * 70)    print("INVENTORY CATEGORIZATION SCRIPT")    print("=" * 70)    print()        # Check command line arguments    if len(sys.argv) < 2:        print("Usage: python categorize_inventory.py input_file.xlsx [output_file.xlsx]")        print()        print("Example:")        print("  python categorize_inventory.py InventoryTemplate.xlsx")        

